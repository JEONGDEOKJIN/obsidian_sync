
# ajax 란? 
``` bash 
- 단어 뜻 
	- asynchronous javascript and XML 
	- asynchronous : 비동기 
	- XML : 데이터를 계층적으로 표현할 수 있음. '데이터 교환의 주요 형식'. 플랫폼 독립적. -> 현재, 더 가볍고, 읽기 쉬운, JSON 형식으로 대체

- ajax 란 
	- 브라우저가 서버에게 '비동기 방식'으로 데이터를 요청하고, 응답 받은 데이터를 바탕으로, 웹 페이지를 '동적으로 업데이트' 할 수 있게 하는 프로그래밍 방식


CF. 정적 업데이트(렌더링) VS 동적 업데이트(렌더링) ⭐⭐⭐⭐⭐⭐ 
	- 정적 
		- 의의 : 서버에서 받아온 파일이, 클라이언트에서, 추가처리 없이, 렌더링됨
		- 특징 
		1) [응답 데이터] 전체 HTML 을 서버에 요청하고, 응답 받음 
		2) [통신 방식] 동기적 -> 블로킹 현상
		3) [렌더링 방식] 특정 부분을 렌더링 하더라도, '처음부터 렌더링' 한다. -> '깜빡이는 현상' 이 발생
		4) [UX] 깜빡이는 느낌  
		
	- 동적
		- 의의 : 서버에서 받아온 파일이, 클라이언트에서 '추가처리' 되고, 렌더링됨
		- 클라이언트는 무엇을 하는가? 
			1) 서버에서 HTML 받고 -> DOM 만들고, 
			2) 특정 상황에서 필요한 데이터를 서버를 통해 다시 받아오면,
			3) innerHTML 같은 메서드를 사용해서 -> 브라우저가 DOM API 로 직접 DOM 을 조작
			4) 그렇게, 클라이언트가 추가 조작한 layout 을 paint 한다. 
		- 특징
		1) [응답 데이터] 필요한, 최신의 데이터 (전체 페이지 새로고침 없이) 를 받아온다.
		2) [통신 방식] 비동기적으로 통신한다. 
		3) [렌더링 방식] 전체 페이지 렌더링이 아닌, 필요한 부분만, 최소한의 DOM 조작으로, 렌더링 한다. 
		4) [UX] 사용자는 '실시간' 으로 반응하는 것 처럼 느껴짐
	
	- 정적 vs 동적의 핵심 
		- [문제 상황 및 해결방식] 
			- '변화된 부분만' 보여주고 싶을 때, 
			- '정적 업데이트'는 '서버로 부터 HTML 수신 -> DOM 생성 -> 렌더트리 -> layout -> paint' 의 과정을 거치고 
			- '동적 업데이트' 는 '서버로 부터 HTML 수신 -> DOM 생성 -> 렌더트리 -> js 에 의한 DOM 조작 -> reflow, repaint -> paint' 로 이루어짐


- ajax 특징 
	- Web API 가 제공하는 'XMLHttpRequest 객체' 를 기반으로 동작.
	- XMLHttpRequest 객체는 비동기 방식으로 통신할 수 있는 프로퍼티와 메서드를 제공.

- ajax 가 해결하고자 하는 문제 상황 
	- '페이지 중 일부만 변경' 하고자 함에도, '서버에 전체 html' 을 '동기적으로 요청' 하고 '전체 html을, 처음부터 렌더링' 을 함 -> '동기 요청에 따른 블로킹 문제', '깜빡이는 현상' 발생 

- ajax 의 특징 
	- [필요한 데이터만 요청] 
		- ajax 로 비동기 통신을 할 때, 1) 초기화 (xhr.open) 2) 필요에 따라 헤더값 설정(xhr.setRequestHeader) 3) 전송(xhr.send) 함 
		- 초기화에서, 리소스가 있는 URL 을 기재함. 
		- 이때, REST API 에 맞게 기재 하면 -> 필요한 데이터만 요청할 수 있음. 
	- [비동기 요청]
		- 초기화 메서드인 xhr.open 의 매개변수로 async 가 있음. 
		- async 의 기본값이 true 임. -> 그러면, 자동적으로 비동기 통신이 됨. 
	- [필요한 부분만 렌더링]
		- innerHTML 과 같이, '응답받은 데이터' 를 'DOM 조작' 을 통해, 'DOM 을 수정' -> reflow, repaint -> 렌더링 

```


![](https://i.imgur.com/JiE7Wx9.png)

![](https://i.imgur.com/E3Xf89m.png)




### 생각할 때 도움되는 포인트 
``` bash 
- '렌더링 과정 이미지'와 'DOM 이미지' 를 참고하여 생각해야 한다.  
	- 특히, '동적 업데이트(렌더링)' 을 이해할 때, 'js 에 의해 DOM 조작 되는 것은 DOM 이미지', 'DOM 조작에 따라 reflow & repaint' 되는 것은 렌더링 프로세스로 이해하면 된다. ⭐⭐⭐ 
	- 그리고 '리액트 렌더링 프로세스' 도, '브라우저 렌더링 프로세스' 하에서 이해하면 된다. ⭐⭐⭐ 

- 'DOM 조작' 은 innerHTML 로 조작하는 코드 상상

```
![](https://i.imgur.com/J8iIyHb.png)

![](https://i.imgur.com/f9Gqps6.png)


![](https://i.imgur.com/odLjPGj.png)


- DOM 은 딱 한번만! 수정함 ⭐⭐ 
	- `innerHTML` 이 딱 한번만! 실행됨 -> reflow, repaint 도 한번만! 
![](https://i.imgur.com/XMfcbT9.png)





# XMLHttpRequest 활용한 HTTP 요청 전송
- 요청 전송
``` bash 

1. XMLHttpsRequest.prototype.open 메서드로 'HTTP 요청을 초기화' 한다. 
	- open 메서드의 매개변수로 async : 비동기 처리를 관리

2. XMLHttpsRequest.prototype.setRequestHeader 메서드로, '필요시' 에, 'HTTP 헤더 정보 값' 을 설정한다. 
	- MIME 타입 설정
		- text 타입 : text/plain, text/html, text/css, text/javascript 
		- application : application/json, application/x-www-font-urlencode
		- multipart : multipart / formed-data

3. XMLHttpsRequest.prototype.send 메서드로, 'HTTP 전송요청' 한다. 
	- 서버로 데이터 전송하는 방식
		- GET 요청 메서드 : query string 에 담아 전송
		- POST 요청 메서드 : 요청 본체 (request body) 에 담아 전송 ⭐⭐⭐⭐⭐
		- 페이로드가 객체면, 반드시, JSON.stringfy 로 '직렬화' 해서 전달. ⭐⭐⭐

(출처 : 모던 자바스크립트 p824)
```


- 전체 응답 흐름 정리 
```bash 
1. 초기화 
	- open 메소드로 진행
	- '비동기 매개변수' 및 'URL 설정 (REST 원칙에 따라서)'

2. 요청 전송
	- send 메서드 
	- 필요시, '페이로드' 함께 전달 

3. [이벤트 캐치(⭐이벤트 핸들러⭐)] 서버가 응답하길 기다리기 ('응답 여부' 확인) 
	- '응답 완료 시' -> xhr.readyState === XMLHttpsRequest.DONE 임 -> 그에 따라, if 문 조건문 실행해주면 됨 ㅣㅐㅁ

4. [이벤트 캐치(⭐이벤트 핸들러)⭐] '정상 여부' 확인 
	- 모든 응답이, 정상인 것은 아님
	- 정상 처리면 -> xhr.status === 200 이면, xhr.response 에 '서버 응답 결과' 가 담김 


- 시사점 
	- SPA 를 활용한다고 해도 1) 초기화(비동기 및 rREST 원칙) 2) 전송(페이로드) 3) 응답 여부 4) 정상 여부 를 확인하는 프로세스는 동일할 것 ⭐⭐⭐⭐⭐⭐⭐ 

(출처 : 모던 자바스크립트 p828)
```


<br>

# JSON 

- ajax 활용한 통신에서, JSON 이 등장하는 이유는? 
``` BASH
- 서버와 클라이언트 간 통신을 할 때, '일정한 데이터 포맷' 이 필요함 
- 과거에는 ajax 를 통한 통신을 할 때, XML 형식으로 진행 (ajax 의 약자인 x 가 XML을 의미)
- 현재에는 JSON 을 'HTTP 통신을 위한 데이터 포맷' 으로 사용하고 있음. 
- 그래서 ajax 파트에서 json 을 공부함 
```

- json 이란 
``` bash 
- '클라이언트와 서버간 HTTP 통신' 을 위한 '텍스트 데이터 포맷' ⭐⭐ (출처 : 모던 자바스크립트 P818)

- 자바스크립트의 '객체 리터럴' 과 유사 
- '키와 값' 으로 구성된 '텍스트' (출처 : 모던 자바스크립트 p818)

- 키는 반드시 "큰따옴표" 를 사용해야 함
```

- 주요 메서드 
``` js 
// '객체, 배열' 를 '문자열' 로 만들기 | 클라이언트가 서버에게 객체를 보내려는 경우 | 직렬화 (serializing) (출처 : 모던 자바스크립트 p819)
JSON.stringfy 

// '문자열' 을 '객체, 배열' 로 만들기 | 서버에서 응답받은 JSON 문자열 을 '객체', '배열 객체' 로 반환
JSON.parse
	// 서버에서 받은 것을 객체로 만드니까, parse 가 맞을듯
```


<br>





# ajax 의 한계 및 해결방안 
- '직접 DOM 조작' 에 따른 비효율성



- SPA 라이브러리가 해결하고자 하는 문제 상황
	- 기존에 동적 업데이트를 진행할 때, 'DOM 을 직접 조작' 함. 
	- 'DOM 직접 조작에 따른 업데이트' 로 인한 ' DOM 조작의 비효율, 코드 복잡성' 이 문제였음. 
		- [DOM 조작의 비효율] 특정 노드만 변경하려 했으나 -> 해당 노드의 자식 까지 변경됨 -> 불필요한 reflow 발생 -> 불필요한 메모리 소모 
		- [코드 복잡성] DOM 조작을 최소화 하기 위한 다양한 방법이 고안 -> ex) 업데이트 되어야 하는 노드를 모으고, 한번에 innerHTML 처리 -> 이 작업만을 위한 코드가 존재. 코드 복잡성 증가.








---
# 궁금증 
``` bash 
ajax 를 통해, 이미, 
1) 부분 데이터 요청 
2) 부분 페이지 렌더링 
3) 비동기가 가능함. 

그래서, 변화된 부분만! 부드러운 화면 전환이 가능함. 
그런데, 왜 SPA 라이브러리 & 프레임 워크가 필요한거지? 
이것들이 virtual DOM 으로 무슨 문제를 해결한다고 하는거지? 

👉 리액트 
```


