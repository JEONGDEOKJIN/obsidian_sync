

# '비동기 처리' 를 위한 '콜백 패턴' 의 단점 

- '비동기 처리' 란? 
``` bash 

- '비동기 함수' 란 '비동기 함수' 안에서 '비동기로 동작하는 코드' 를 포함한 함수. (출처 : 모던 자바스크립트 p844)

- 비동기 처리란
	- '비동기로 동작하는 코드'의 '실행' '결과값'을, '어떻게 제어(컨트롤)' 하는 것.
	ex) 응답 결과를 -> 어디에 넣어서 -> 뭔가를 만들겠다. 


'비동기로 동작하는 코드' 의 '처리 결과' 를 
	1) 외부로 반환(return) 하거나 
	2) 상위 스코프의 변수로 할당


(출처 : 모던 자바스크립트 p842)
```


<br>

### 비동기 방식으로 동작하는 코드의 실행결과값이, 마음대로 컨트롤되지 않는 경우 
- 모두 이와 같을 수는 없겠지만, 문제를 유형별로 묶었을 때, 더 나은 방안이 나올 수 있음 ⭐⭐⭐⭐⭐ 

- 'onload 이벤트가 발생했을 때 실행되는 콜백함수(xhr.onload 이벤트 핸들러의 프로퍼티에 바인딩된 이벤트 핸들러)' 는 언제 실행되나? 원하는 곳에서 콜백함수의 처리값을 콘솔로 보려면? ⭐⭐⭐⭐⭐⭐ 
``` js 
// [하고 싶은 것] '비동기 코드 실행 결과값' 을 console 로 찍고 싶음

const get = url => { 
	const xhr = new XMLHttpRequest( );
	xhr.open('GET' , url);     // 초기화
	xhr.send( );     // http 요청 전송 | 비동기 처리 코드 임(XMLHttpRequest 을 web api 가 내장하고 있기 때문) -> so, 아래 코드 즉시 실행  

	// 이벤트 핸들러 '바인딩(등록)' = 'onload 이벤트 발생시', '실행될 함수(콜백함수)' 를 등록 ⭐⭐⭐ 
	xhr.onload = ( ) => { 
		if(xhr.status === 200) {
			// 서버 응답을 콘솔에 출력 
				return JSON.parse(xhr.response)
		} else {
			console.error(`${xhr.status} ${xhr.statusText}`)
		}
	}
		// ⭐ 바인딩(등록) 되면, 'onload 이벤트 발생 여부' 및 'onload 발생시, 함수 실행(task queue 에 콜백함수 전달)' 역할을 누군가 해야 함 ⭐⭐⭐⭐⭐⭐  
			//  xhr.onload 는 XMLHttpRequest의 프로퍼티이고, XMLHttpRequest은 web api 가 제공하므로, js 엔진이 이 역할을 맡기에 무리 -> so, '이벤트 체크' 및 '이벤트 발생시 task queue 에 해당 콜백함수 전달' 은 '브라우저' 가 담당 
			// 따라서, onload 발생시 실행되는 콜백함수(onload 프로퍼티에 바인딩된 이벤트 핸들러) 는, task queue 에 대기하다가, js 엔진 콜스택이 전부 empty 가 된 후 실행된다. 

const response = get( 'http://jsonplaceholder.typicode.com/posts/1' )

console.log(response)  // undefined


/* get 함수 '평가 - 실행' 분석  
	1. 평가 
		- get 등록
		- response 등록 / 초기값 uninitialized
	
	2. 실행
		2.1 get 실행 컨텍스트 생성 
		2.2 get 함수 평가 
		2.3 get 함수 실행
		2.4 xhr 변수에 XMLHttpRequest 객체 할당 -> open -> send 실행 
		2.5 onload 실행 -> xhr.onload 이벤트 핸들러 '프로퍼티' 에 , '이벤트 핸들러' 를 '⭐바인딩⭐' 
			- 즉, 'onload 이벤트 발생시 실행될 함수를 지정함'
			- 즉, 
				- XMLHttpRequest 안에 있는 onload 프로퍼티는, 'onload 이벤트' 가 발생했을 때 실행되는 함수가 정의되는 곳 임. 
				- 현재, 해당 프로퍼티에, onload 이벤트 발생시, 실행될 행동을 정의해둔 것 임. 
				- 이걸, 'xhr.onload 이벤트 핸들러 프로퍼티' 에 '특정 이벤트 발생시 실행될 함수' 를 '바인딩' 했다고 말함 ⭐⭐⭐⭐⭐ 
		2.6 종료
	
	- 질문 
		- '이벤트 핸들러를 바인딩' 했다는 건, 해당 이벤트가 발생했을 때, 특정한 방식으로 처리해줄 코드를 기재했다는 건가? 👉 응. 그냥, 등록했다는 의미. 그래서, 실제로 'onload 이벤트를 캐치' 하려면, 실행 해줘야 해

*/

```


